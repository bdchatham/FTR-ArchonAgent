version: "1.0"

build:
  commands:
    - npm install --include=dev
    - npm run build
    - npm test

environments:
  - name: dev
    region: us-east-1
    account: "371601828463"
    stacks:
      # Stacks deploy in order listed - dependencies first
      - name: ArchonInfrastructureStack
        path: lib/archon-infrastructure-stack.ts
      - name: ArchonKnowledgeBaseStack
        path: lib/archon-knowledge-base-stack.ts
      - name: ArchonAgentStack
        path: lib/archon-agent-stack.ts
      - name: ArchonMonitoringDashboard
        path: lib/archon-monitoring-dashboard.ts
    tests:
      commands:
        - npm run test:integration
